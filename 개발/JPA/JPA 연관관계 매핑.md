# ğŸ¼ JPA ì—°ê´€ê´€ê³„ ë§¤í•‘

### ë°©í–¥
- ë‹¨ë°©í–¥ : íšŒì› -> íŒ€
- ì–‘ë°©í–¥ : íšŒì› -> íŒ€, íŒ€ -> íšŒì›  
> ë°©í–¥ì€ ê°ì²´ê´€ê³„ì—ë§Œ ì¡´ì¬í•˜ê³  í…Œì´ë¸” ê´€ê³„ëŠ” í•­ìƒ ì–‘ë°©í–¥ì´ë‹¤.
  
### ë‹¤ì¤‘ì„±
- N:1, 1:N, 1:1, N:N
- íšŒì› -> íŒ€ :  íšŒì›ê³¼ íŒ€(ë‹¤ëŒ€ì¼) íŒ€ê³¼ íšŒì›(ì¼ëŒ€ë‹¤) 
  
### ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸
ê°ì²´ë¥¼ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¡œ ë§Œë“¤ë©´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì •í•´ì•¼í•œë‹¤.
  
## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„
### ì—°ê´€ê´€ê³„ ì¤‘ì—ì„  (N:1) ë‹¨ë°©í–¥ ê´€ê³„ë¥¼ ê°€ì¥ ë¨¼ì € ì´í•´í•´ì•¼ í•œë‹¤. ì§€ê¸ˆë¶€í„° íšŒì›ê³¼ íŒ€ì˜ ê´€ê³„ë¥¼ í†µí•´ ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ ê´€ê³„ë¥¼ ì•Œì•„ë³´ì
- íšŒì›ê³¼ íŒ€ì´ ìˆë‹¤.
- íšŒì›ì€ í•˜ë‚˜ì˜ íŒ€ì—ë§Œ ì†Œì†ë  ìˆ˜ ìˆë‹¤.
- íšŒì›ê³¼ íŒ€ì€ ë‹¤ëŒ€ì¼ ê´€ê³„ì´ë‹¤.
![image](https://user-images.githubusercontent.com/71022555/164226235-4b73dfaa-f9e2-4389-bdab-a4dea88de475.png) 
##### ê·¸ë¦¼1
  
### ê·¸ë¦¼ ì„¤ëª…
- ê°ì²´ ì—°ê´€ê´€ê³„
    - íšŒì› ê°ì²´ëŠ” Member.team í•„ë“œ(ë©¤ë²„ ë³€ìˆ˜)ë¡œ íŒ€ ê°ì²´ì™€ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.
    - íšŒì› ê°ì²´ì™€ íŒ€ ê°ì²´ëŠ” ë‹¨ë°©í–¥ ê´€ê³„ì´ë‹¤. íšŒì›ì€ Member.team í•„ë“œë¥¼ í†µí•´ì„œ íŒ€ì„ ì•Œ ìˆ˜ ìˆì§€ë§Œ ë°˜ëŒ€ë¡œ íŒ€ì€ íšŒì›ì„ ì•Œ ìˆ˜ ì—†ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ member -> teamì˜ ì¡°íšŒëŠ” member.getTeam()ìœ¼ë¡œ ê°€ëŠ¥í•˜ì§€ë§Œ ë°˜ëŒ€ ë°©í–¥ì¸ team -> memberë¥¼ ì ‘ê·¼í•˜ëŠ” í•„ë“œëŠ” ì—†ë‹¤.
- í…Œì´ë¸” ì—°ê´€ê´€ê³„
    - íšŒì› í…Œì´ë¸”ì€ TEAM_ID ì™¸ë˜ í‚¤ë¡œ íŒ€ í…Œì´ë¸”ê³¼ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.
    - íšŒì› í…Œì´ë¸”ê³¼ íŒ€ í…Œì´ë¸”ì€ ì–‘ë°©í–¥ ê´€ê³„ì´ë‹¤. íšŒì› í…Œì´ë¸”ì˜ TEAM_ID ì™¸ë˜ í‚¤ë¥¼ í†µí•´ì„œ íšŒì›ê³¼ íŒ€ì„ ì¡°ì¸í•  ìˆ˜ ìˆê³  ë°˜ëŒ€ë¡œ íŒ€ê³¼ íšŒì›ë„ ì¡°ì¸í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ MEMBER í…Œì´ë¸”ì˜ TEAM_ID ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ MEMBER JOIN TEAMê³¼ TEAM JOIN MEMEBER ë‘˜ ë‹¤ ê°€ëŠ¥í•˜ë‹¤.
- ê°ì²´ ì—°ê´€ê´€ê³„ì™€ í…Œì´ë¸” ì—°ê´€ê´€ê³„ì˜ ê°€ì¥ í° ì°¨ì´
> ì°¸ì¡°ë¥¼ í†µí•œ ì—°ê´€ê´€ê³„ëŠ” ì–¸ì œë‚˜ **ë‹¨ë°©í–¥**ì´ë‹¤. ê°ì²´ê°„ì— ì—°ê´€ê´€ê³„ë¥¼ ì–‘ë°©í–¥ìœ¼ë¡œ ë§Œë“¤ê³  ì‹¶ìœ¼ë©´ ë°˜ëŒ€ìª½ì—ë„ í•„ë“œë¥¼ ì¶”ê°€í•´ì„œ ì°¸ì¡°ë¥¼ ë³´ê´€í•´ì•¼ í•œë‹¤. ê²°êµ­ ì—°ê´€ê´€ê³„ë¥¼ í•˜ë‚˜ ë” ë§Œë“¤ì–´ì•¼ í•œë‹¤.  ì´ë¥¼ **ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¼ í•œë‹¤.** ì •í™•í•˜ê²ŒëŠ” **ì„œë¡œ ë‹¤ë¥¸ ë‹¨ ë°©í–¥ ê´€ê³„ 2ê°œì´ë‹¤.**
```java
// ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„
class A{
    B b;
}
class B{

}
// ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„
class A{
    B b;
}
class B{
    A a;
}
```
### ê°ì²´ ì—°ê´€ê´€ê³„ vs í…Œì´ë¸” ì—°ê´€ê´€ê³„
> ê°ì²´ëŠ” **ì°¸ì¡°(ì£¼ì†Œ)**ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.  
í…Œì´ë¸”ì€ **ì™¸ë˜ í‚¤**ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.  
ì´ ë‘˜ì€ ë¹„ìŠ·í•´ ë³´ì´ì§€ë§Œ ê°ì²´ëŠ” ì°¸ì¡°(a.getB())ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ í…Œì´ë¸”ì€ **ì¡°ì¸**ì„ ì‚¬ìš©í•œë‹¤.
- ì°¸ì¡°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê°ì²´ì˜ ì—°ê´€ê´€ê³„ëŠ” ë‹¨ë°©í–¥ì´ë‹¤.
- ì™¸ë˜í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ” í…Œì´ë¸”ì˜ ì—°ê´€ê´€ê³„ëŠ” ì–‘ë°©í–¥ì´ë‹¤.

## ğŸ¤  ê°ì²´ ê´€ê³„ ë§¤í•‘
ìœ„ì˜ ê·¸ë¦¼1 ê¸°ì¤€ JPAë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘˜ì„ ë§¤í•‘í•´ë³´ì.
```java
@Entity
public class Member{
    @Id
    @Column(name = "MEMBER_ID")
    private String id;
    private String username;

    // ì—°ê´€ê´€ê³„ ë§¤í•‘
    @ManyToOne
    @JoinColumn(name="TEAM_ID")
    private Team team;

    // ì—°ê´€ê´€ê³„ ì„¤ì •
    public void setTeam(Team team){
        this.team = team;
    }
}

@Entity
public class Team{
    @Id
    @Coluimn(name ="TEAM_ID")
    private String id;
    
    private String name;
}
```
- ê°ì²´ ì—°ê´€ê´€ê³„ : íšŒì› ê°ì²´ì˜ Member.teamì„ ì‚¬ìš©
- í…Œì´ë¸” ì—°ê´€ê´€ê³„ : íšŒì› í…Œì´ë¸”ì˜ MEMBER.TEAM_ID ì™¸ë˜ í‚¤ ì»¬ëŸ¼ ì‚¬ìš©
### ì–´ë…¸í…Œì´ì…˜ ì„¤ëª…
> **@ManyToOne** : ì´ë¦„ ê·¸ëŒ€ë¡œ ë‹¤ëŒ€ì¼(N:1) ê´€ê³„ë¼ëŠ” ë§¤í•‘ ì •ë³´ë‹¤. íšŒì›ê³¼ íŒ€ì€ ë‹¤ëŒ€ì¼ ê´€ê³„ì´ë‹¤. ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ì´ë ‡ê²Œ ë‹¤ì¤‘ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ì–´ë…¸í…Œì´ì…˜ì„ í•„ìˆ˜ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.  
**@JoinColumn(name="TEAM_ID")** : ì¡°ì¸ ì»¬ëŸ¼ì€ ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©í•œë‹¤. name ì†ì„±ì—ëŠ” ë§¤í•‘í•  ì™¸ë˜ í‚¤ ì´ë¦„ì„ ì§€ì •í•œë‹¤. íšŒì›ê³¼ íŒ€ í…Œì´ë¸”ì€ TEAM_ID ì™¸ë˜ í‚¤ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºìœ¼ë¯€ë¡œ ì´ ê°’ì„ ì§€ì •í•˜ë©´ ëœë‹¤. ì´ ì–´ë…¸í…Œì´ì…˜ì€ ìƒëµí•  ìˆ˜ ìˆë‹¤.

### @JoinColumn
|ì†ì„±|ê¸°ëŠ¥|ê¸°ë³¸ê°’|
|:---|:---|:---|
|name|ë§¤í•‘í•  ì™¸ë˜ í‚¤ ì´ë¦„|í•„ë“œëª…+_+ì°¸ì¡°í•˜ëŠ” í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ ëª…|
|referencedColumnName|ì™¸ë˜ í‚¤ê°€ ì°¸ì¡°í•˜ëŠ” ëŒ€ìƒ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª…|ì°¸ì¡°í•˜ëŠ” í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ëª…|
|foreignKey(DDL)|ì™¸ë˜ í‚¤ ì œì•½ì¡°ê±´ì„ ì§ì ‘ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ì´ ì†ì„±ì€ í…Œì´ë¸”ì„ ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©í•œë‹¤.||
|unique, nullable, insertable, updatable, columnDefinitaion, table|@Column ì†ì„±ê³¼ ê°™ë‹¤.||

### @ManyToOne
|ì†ì„±|ê¸°ëŠ¥|ê¸°ë³¸ê°’|
|:---|:---|:---|
|optional|falseë¡œ ì„¤ì •í•˜ë©´ ì—°ê´€ëœ ì—”í‹°í‹°ê°€ í•­ìƒ ìˆì–´í– í•œë‹¤.|true|
|fetch|ê¸€ë¡œë²Œ íŒ¨ì¹˜ ì „ëµì„ ì„¤ì •í•œë‹¤.(N+1) ë¬¸ì œ|@ManyToOne=FetchType.EAGER @OneToMany=FetchType.LAZY|
|cascade|ì˜ì†ì„± ì „ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.||
|targetEntity|ì—°ê´€ëœ ì—”í‹°í‹°ì˜ íƒ€ì… ì •ë³´ë¥¼ ì„¤ì •í•œë‹¤. ì´ ê¸°ëŠ¥ì€ ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•´ë„ ì œë„ˆë¦­ìœ¼ë¡œ íƒ€ì…ì •ë³´ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.||
```java
// targetEntity ì„¤ëª…
// ì œë„ˆë¦­
@OneToMany
private List<Member> members;

@OneToMany(targetEntity=Member.class)
private List members;
```

## ğŸ‘ ì—°ê´€ê´€ê³„ ì‚¬ìš©
### ì €ì¥
```java
public void test(){
    // íŒ€1 ì €ì¥
    Team team1 = new Team("team1", "1íŒ€");
    em.persist(team1); // save()ëŠ” ì €ì¥í›„ ID ê°’ì„ returní•œë‹¤. persistëŠ” ë°˜í™˜í˜•ì´ void

    //íšŒì› ì €ì¥
    Memeber member1 = new Member("member1", "íšŒì›1");
    member1.setTeam(team); // ì—°ê´€ê´€ê³„ ì„¤ì • memeber1 -> 
    em.persist(member1);
    team1
}
```
### ì¡°íšŒ
ì—°ê´€ê´€ê³„ê°€ ìˆëŠ” ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•ì€ í¬ê²Œ 2ê°€ì§€ ì´ë‹¤.
1. ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰(ê°ì²´ ì—°ê´€ê´€ê³„ë¥¼ ì‚¬ìš©í•œ ì¡°íšŒ)
2. ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì‚¬ìš©(JPQL)

```java
// ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰
Member member = em.find(Member.class "member1");
Team team = member.getTeam();
```
```java
// ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì‚¬ìš©
private static void queryLogicJoin(EntityManager em) {
    String jpql = "select m from Member m join m.team t where" + "t.name=:teamName";

    List<Member> resultList = em.createQuery(jpql, Member.class).setParameter("teamName","íŒ€1").getResultList();

    for(Member member : resultList){
        System.out.println("[query] memeber.userName="+member.getUsername());
    }
}
// ê²°ê³¼
[query] member.username=íšŒì›1
[query] member.username=íšŒì›2

/* ì‹¤í–‰ ê³¼ì •
:teamNameëŠ” íŒŒë¼ë¯¸í„°ë¡œ ë°”ì¸ë”©ë°›ëŠ” ë¬¸ë²•ì´ë‹¤.
select m from Member m join m.team t where t.name=:teamName

SELECT M.* FROM MEMBER MEMBER
INNER JOIN
    TEAM TEAM ON MEMBER.TEAM_ID = TEAM1_.ID
WHERE 
    TEAM1_.NAME="íŒ€1"
*/
```

### ìˆ˜ì •
```java
private static void update(EntityManager em){
    Team team2 = new Team("team2", "íŒ€2");
    em.persist(team2);

    Member member = em.find(Member.class, "member1");
    member.setTeam(team2);
}
// ìˆ˜ì •ì€ em.update() ê°™ì€ ë©”ì†Œë“œê°€ ì—†ë‹¤. ë‹¨ìˆœíˆ ë¶ˆëŸ¬ì˜¨ ì—”í‹°í‹°ì˜ ê°’ë§Œ ë³€ê²½í•´ë‘ë©´ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œ flushê°€ ì¼ì–´ë‚˜ë©´ì„œ ë³€ê²½ ê°ì§€ ê¸°ëŠ¥ì´ ì‘ë™í•œë‹¤. ê·¸ë¦¬ê³  ë³€ê²½ì‚¬í•­ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìë™ìœ¼ë¡œ ë°˜ì˜í•œë‹¤. ì´ëŠ” ì—°ê´€ê´€ê³„ë¥¼ ìˆ˜ì •í•  ë•Œë„ ê°™ë‹¤.
```
### ì—°ê´€ê´€ê³„ ì œê±°
```java
private static void deleteRelation(EntityManager em){
    Member member1 = em.find(Member.class, "member1");
    member1.setTeam(null);
}
```

### ì—°ê´€ëœ ì—”í‹°í‹° ã……í•™ì œ
ì—°ê´€ëœ ì—”í‹°í‹°ë¥¼ ì‚­ì œí•˜ë ¤ë©´ **ê¸°ì¡´ì— ìˆë˜ ì—°ê´€ê´€ê³„ë¥¼ ë¨¼ì € ì œê±°í•˜ê³  ì‚­ì œí•´ì•¼ í•œë‹¤.**
```java
member1.setTeam(null);
member2.setTeam(null);
em.remove(team);
```

## ğŸ‘ ì–‘ë±¡í–¥ ì—°ê´€ê´€ê³„
ì§€ê¸ˆê¹Œì§€ëŠ” íšŒì›ì—ì„œ íŒ€ìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ” ë‹¤ëŒ€ì¼ ë‹¨ë±¡í–¥ ë§¤í•‘ì´ì˜€ë‹¤. ì´ë²ˆì—ëŠ” íŒ€ì—ì„œ íšŒì›ìœ¼ë¡œ ì ‘ê·¼í•˜ëŠ” ê´€ê³„ë¥¼ ì¶”ê°€í•´ë³´ì.
![image](https://user-images.githubusercontent.com/71022555/167242241-bf74de2c-062b-4428-8c1a-fee9a53edabc.png)  

### ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ë§¤í•‘
```java
// íšŒì› ì—”í‹°í‹°ëŠ” ê¸°ì¡´ ê·¸ëŒ€ë¡œ ì§„í–‰

@Entity
public class Team{
    @Id
    @Coluimn(name ="TEAM_ID")
    private String id;
    
    private String name;

    // ì¶”ê°€ëœ ë¶€ë¶„
    @OneToMany(mappedBy = "team")
    private List<Member> members = new ArrayList<Member>();
}
// ì¼ëŒ€ë‹¤ ê´€ê³„ ì´ë¯€ë¡œ íŒ€ ì—”í‹°í‹°ì— List<Member> members ë¦¬ìŠ¤íŠ¸ ì»¬ë ‰ì…˜ì„ ì¶”ê°€í•˜ì˜€ë‹¤. 
// mappedBy ì†ì„±ì€ ì–‘ë°©í–¥ ë§¤í•‘ì¼ ë•Œ ì‚¬ìš©í•˜ëŠ” ë°˜ëŒ€ìª½ ë§¤í•‘ì˜ í•„ë“œ ì´ë¦„ì„ ê°‘ìœ¼ë¡œ ì£¼ë©´ ëœë‹¤. ë°˜ëŒ€ìª½ ë§¤í•‘ì´ Team teamì´ë¯€ë¡œ teamì„ ê°’ìœ¼ë¡œ ì£¼ì—ˆë‹¤.
```
### ì¼ëŒ€ë‹¤ ì»¬ë ‰ì…˜ ì¡°íšŒ
```java
public void biDirection(){
    Team team = en.find(Team.class "team1");
    List<Member> members = team.getMembers();

    for(Member member : members){
        System.out.println("member.username = "+member.getUsername());
    }
}
```
## ğŸ•µï¸â€â™‚ï¸ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸
@OneToManyë¿ë§Œì•„ë‹ˆë¼ **mappedBy**ëŠ” ì™œ í•„ìš”í•œ ê²ƒì¸ê°€?
> ê°ì²´ì—ëŠ” ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¼ëŠ” ê²ƒì´ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.  
ì¦‰ **í…Œì´ë¸”ì€ í‚¤ í•˜ë‚˜ë¡œ ë‘ í…Œì´ë¸”ì˜ ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬**í•œë‹¤.  
ì´ ìƒí™©ì—ì„œ ì—”í‹°í‹°ë¥¼ ì–‘ë°©í–¥ìœ¼ë¡œ ë§¤í•‘í•˜ë©´ íšŒì› -> íŒ€, íŒ€ -> íšŒì› ë‘ ê³³ì—ì„œ ì„œë¡œë¥¼ ì°¸ì¡°ë‚˜ë‹¤. ë”°ë¼ì„œ ì´ëŸ¬í•œ ìƒí™©ì—ì„œ **ì°¸ì¡°ëŠ” ë‘˜ ì™¸ë˜í‚¤ëŠ” í•˜ë‚˜**ë¼ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.  
ì´ëŸ° ì°¨ì´ë¡œ ì¸í•´ JPAì—ì„œëŠ” **ë‘ ê°ì²´ ì—°ê´€ê´€ê³„ ì¤‘ í•˜ë‚˜ë¥¼ ì •í•´ì„œ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•´ì•¼ í•˜ëŠ”ë° ì´ê²ƒì„ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸**ì´ë¼ í•œë‹¤.  

### ì—°ê´€ê´€ê³„ ì£¼ì¸ ê·œì¹™
- **ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê´€ê´€ê³„ì™€ ë§¤í•‘ë˜ê³  ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬(ë“±ë¡, ìˆ˜ì •, ì‚­ì œ)ë¥¼ í•  ìˆ˜ ìˆë‹¤.** ë°˜ë©´ì— ì£¼ì¸ì´ ì•„ë‹Œ ìª½ì€ ì½ê¸°ë§Œ í•  ìˆ˜ ìˆë‹¤.
- ì£¼ì¸ì€ **mappedBy**ì†ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¦‰ mappedByê°€ ì—†ëŠ” ìª½ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤.
![image](https://user-images.githubusercontent.com/71022555/167242471-fdb3bf26-5f16-4e8a-a73f-ca79fdf6b6eb.png)  

```java
// íšŒì› -> íŒ€
class Member{
    @ManyToOne
    @JoinColumn(name="TEAM_ID")
    private Team team;
}
// íŒ€ -> íšŒì›
class Team{
    @OneToMany
    private List<Member> members = new ArrayList<Member>();
}
```
> **ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì •í•œë‹¤ëŠ” ê²ƒì€ ì™¸ë˜ í‚¤ ê´€ë¦¬ìë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ë‹¤.**  
ì—¬ê¸°ì„œëŠ” íšŒì› í…Œì´ë¸”ì— ìˆëŠ” TEAM_ID ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•  ê´€ë¦¬ìë¡œ ì„ íƒí•˜ì•¼ í•œë‹¤.  
ì—¬ê¸°ì„œ íšŒì› ì—”í‹°í‹°ì— ìˆëŠ” Member.teamì„ ì£¼ì¸ìœ¼ë¡œ ì„ íƒí•˜ë©´ ìê¸° í…Œì´ë¸”ì— ìˆëŠ” ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•˜ë©´ ëœë‹¤.  
í•˜ì§€ë§Œ íŒ€ ì—”í‹°í‹°ì— ìˆëŠ” Team.membersë¥¼ ì£¼ì¸ìœ¼ë¡œ ì„ íƒí•˜ë©´ ë¬¼ë¦¬ì ìœ¼ë¡œ ì „í˜€ ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•´ì•¼í•œë‹¤. ì´ ê²½ìš° Team.membersê°€ ìˆëŠ” Team ì—”í‹°í‹°ëŠ” TEAM í…Œì´ë¸”ì— ë§¤í•‘ë˜ì–´ ìˆëŠ”ë° ê´€ë¦¬í•´ì•¼í•  ì™¸ë˜ í‚¤ëŠ” MEMBERí…Œì´ë¸”ì— ìˆê¸° ë•Œë¬¸ì´ë‹¤.
### ì—°ê´€ê´€ê²Œì˜ ì£¼ì¸ì€ ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³
ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³ìœ¼ë¡œ ì •í•´ì•¼ í•œë‹¤.  
ì—¬ê¸°ì„œëŠ” íšŒì› í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë¯€ë¡œ Member.teamì´ ì£¼ì¸ì´ ëœë‹¤.

## ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì €ì¥
```java
public void test(){
    // íŒ€1 ì €ì¥
    Team team1 = new Team("team1", "1íŒ€");
    em.persist(team1); // save()ëŠ” ì €ì¥í›„ ID ê°’ì„ returní•œë‹¤. persistëŠ” ë°˜í™˜í˜•ì´ void

    //íšŒì› ì €ì¥
    Memeber member1 = new Member("member1", "íšŒì›1");
    member1.setTeam(team1); // ì—°ê´€ê´€ê³„ ì„¤ì • memeber1 -> team1
    em.persist(member1);
}
// ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ëŠ” ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•œë‹¤. ë”°ë¼ì„œ ì£¼ì¸ì´ ì•„ë‹Œ ë°©í–¥ì€ ê°’ì„ ì„¤ì •í•˜ì§€ ì•Šì•„ë„ DBì— ì™¸ë˜ í‚¤ ê°’ì´ ì •ìƒ ì…ë ¥ëœë‹¤.
team1.getMembers{}.add(member1); // ë¬´ì‹œ ëœë‹¤.(ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ X)

member1.setTeam(team1); //ì—°ê´€ê´€ê³„ ì„¤ì •(ì—°ê´€ê´€ê³„ ì£¼ì¸)

```

## â— ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì˜ ì£¼ì˜ì 
ì—°ê´€ê´€ê³„ ì£¼ì¸ì—ëŠ” ê°’ì„ ì…ë ¥í•˜ì§€ ì•Šê³  ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì—ë§Œ ê°’ì„ ì…ë ¥í•˜ëŠ” ê²ƒì´ë‹¤.

```java
// ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì—ë§Œ ê°’ ì„¤ì •
public void testSave(){
    // íšŒì› 1 ì €ì¥
    Member member1 = new Member("member1", "íšŒì›1");
    em.persist(member1);

    // íšŒì› 2 ì €ì¥
    Member member2 = new Member("member2", "íšŒì›2");
    em.persist(member2);

    Team team1 = new Team("team1", "íŒ€1");
    // ì£¼ì¸ì´ ì•„ë‹Œ ê³³ì—ë§Œ ì—°ê´€ê´€ê³„ ì„¤ì •
    team1.getMembers{}.add(member1);
    team1.getMembers{}.add(member2);
    
    em.persist(team1)
}
// ê²°ê³¼ ì¡°íšŒì‹œ
MEMBER_ID USERNAME TEAM_ID
member1   íšŒì›1     null
member2   íšŒì›2     null
```
ì™¸ë˜ í‚¤ TEAM_IDì— team1ì´ ì•„ë‹Œ null ê°’ì´ ì…ë ¥ë˜ì–´ ìˆëŠ”ë°, ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹Œ Team.membersì—ë§Œ ê°’ì„ ì €ì¥í–ˆê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰ **ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ ì™¸ë˜ í‚¤ì˜ ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.** ì´ ì½”ë“œì—ì„œëŠ” Member.teamì— ì•„ë¬´ ê°’ë„ ì…ë ¥í•˜ì§€ ì•Šì•˜ë‹¤. ë”°ë¼ì„œ TEAM_ID ì™¸ë˜ í‚¤ì˜ ê°’ë„ nullì´ ì €ì¥ëœë‹¤.

### ìˆœìˆ˜í•œ ê°ì²´ê¹Œì§€ ê³ ë ¤í•œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„
JPAë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìˆœìˆ˜í•œ ê°ì²´ ìƒíƒœì—ì„œëŠ” ì–‘ìª½ì— ë‹¤ ê°’ì„ ì…ë ¥í•´ì£¼ì–´ì•¼ ì‹¬ê°í•œ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
```java
public void testObject(){
    // íŒ€1
    Team team1 = new Team("team1", "íŒ€1");
    Member member1 = new Member("member1", "íšŒì›1");
    Member member2 = new Member("member2", "íšŒì›2");    

    member1.setTeam(team1);
    member2.setTeam(team1);

    List<Member> members = team1.getMembers();

    System.out.println(members.size());    
        
}
// ê²°ê³¼ëŠ” 0ì´ ì¶œë ¥ëœë‹¤.
// Member.teamì—ë§Œ ì—°ê´€ê´€ê³„ë¥¼ ì €ì¥í–ˆë‹¤.
team1.getMembers{}.add(member1); // ì²˜ëŸ¼ ì–‘ìª½ ë‹¤ ê´€ê³„ë¥¼ ì„¤ì •í•´ì•¼ í•œë‹¤.
```

### ë‘˜ ë‹¤ ê³ ë ¤í•œ ì½”ë“œ
```java
public void testPerfect(){

    // íŒ€1 ì €ì¥
    Team team1 = new Team("team1", "íŒ€1");
    em.persist(team1);
    
    Member member1 = new Member("member1", "íšŒì›1");    

    // ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì„¤ì •
    member1.setTeam(team1); // member1 -> team1
    team1.getMembers{}.add(member1);  // team1 -> member1
    em.persist(member1);

    Member member2 = new Member("member2", "íšŒì›2");  team1.getMembers{}.add(member2);
    em.persist(member2);  
}
```

### ë¦¬íŒ©í† ë§ í•œ ì½”ë“œ
```java
public class Memeber{
    private Team team;
    
    public void setTeam(Team team){
        this.team = team;
        this.getMembers().add(this);
    }
}

Member.setTeam(team) // ë©”ì†Œë“œ í•˜ë‚˜ë¡œ ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ëª¨ë‘ ì„¤ì •í•˜ë„ë¡ ë³€ê²½
```

### í¸ì˜ ë©”ì†Œë“œ ì‘ì„± ì‹œ ìœ ì˜ ì‚¬í•­
```java
member1.setTeam(team1); 
member2.setTeam(team2); 
Member findMember = team1.getMember(); // member1ì´ ì—¬ì „íˆ ì¡°íšŒëœë‹¤.

// ê¸°ì¡´ì— team2ë¡œ ë³€ê²½í•  ë•Œ team1 -> member1 ê´€ê³„ë¥¼ ì œê±°í•˜ì§€ ì•Šì•„ì„œ member1ì´ ì—¬ì „íˆ ê²€ìƒ‰ëœë‹¤.

public void setTeam(Team team){
    if(this.team != null){
        this.team.getMembers().remove(this);
    }

    this.team = team;
    this.getMembers().add(this);
}
```