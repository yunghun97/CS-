# 트랜잭션

<br>

### 데이터베이스의 상태를 변환시키는 하나의 논리적 기능을 수행하기 위한 작업의 단위 또는 한꺼번에 모두 수행되어야 할 일련의 연산들을 의미한다.
- ### 데이테베이스는 정확한 데이터를 유지하며 오류 발생 시 빠르게 복구하고, 데이터베이스가 항상 정확하고 일관된 상태를 유지할 수 있도록 다양한 기능을 제공하는데 그 중심에서 가장 중요한 역할을 하는 것이 바로 트랜잭션이다.
    - 트랜잭션을 관리함으로써 데이터베이스의 회복과 병행제어가 가능
- ### 작업 수행에 필요한 SQL 문들의 모임
- ### 트랜잭션의 모든 명령문이 완벽하게 처리되거나 하나도 처리되지 않아야 데이터 베이스 모순이 없는 일관된 상태를 유지
- ### 트랜잭션은 데이터베이스에 장애가 발생했을 때 복구잡업을 수행하거나, 다수의 사용자가 동시에 사용할 수 있도록 제어 작업을 하는 데 중요한 단위로 사용.
<br>

## 트랜잭션의 특징(ACID)

<br>

### 트랜잭션이 성공적으로 처리되어 데이터베이스의 무결성과 일관성을 보장하려면 4가지 특성을 만족해야 한다.

1. ### Atomicity(원자성)
2. ### Consistendcy(일관성)
3. ### Isolation(격리성)
4. ### Durability(지속성)

## 1. Atomicity(원자성)
-   트랜잭션이 데이터베이스에 모두 반영되던가, 아니면 전혀 반영되지 않아야 한다는 것이다.  
## 2. 일관성(Consistendcy)
-   트랜잭션이 성공적으로 수행된 후에도 데이터베이스가 일관성 있는 상태를 유지해야 함을 의미 ex) 게좌 이체 진행
## 3. 격리성(Isolation)
-   현재 수행 중인 트랜잭션이 완료될 때까지 트랜잭션이 생성한 중간 연산 결과에 다른 트랜잭션이 접근할 수 없다.
-   각 트랜잭션이 독립적으로 수행될 수 있도록 한다.
## 4. 지속성(Durability)
-   트랜잭션이 성공적으로 완료된 후 데이터베이스에 반영한 수행 결과는 손실되지 않고 영구적으로 존재해야한다.
-   시스템 장애가 발생하더라도 작업 결과는 데이터베이스가 그대로 남아있어야 한다.
-    지속성 보장을 위해 시스템 장애가 발생했을 때 데이터베이스를 원래 상태로 복구하는 회복 기능이 필요
<br>

## 트랜잭션의 상태
<br>

![image](https://user-images.githubusercontent.com/71022555/137618034-8e48092e-2cdc-40d1-8105-30fe3a475e82.png)

### 활동(Active) : 트랜잭션이 실행중인 상태
<br>

### 실패(Failed) : 트랜잭션 실행에 오류가 발생하여 중단된 상태
<br>

### 철회(Aborted) : 트랜잭션이 비정상적으로 종료되어 Rollback 연산을 수행한 상태
<br>

### 부분 완료(Partially Committed) : 트랜잭션의 마지막 연산까지 실행했지만, Commit 연산이 실행되기 직전의 상태
<br>

### 완료(Committed) : 트랜잭션이 성공적으로 종료되어 Commit 연산을 실행한 후의 상태
<br>

## 회복기법
---
<br>

## 1. 로그 기반 회복 기법
### 지연갱신 회복 기법(Deferred Update)
-   트랜잭션의 부분 완료 상태에선 변경 내용을 로그 파일에만 저장
-   커밋이 발생하기 전까진 데이터베이스에 기록하지 않음
-   중간에 장애가 생기더라도 데이터베이스에 기록되지 않았으므로 UNDO가 필요 없음(미실행 된 로그 폐기)
### 즉시갱신 회복 기법(Immediate Update)
-   트랜잭션 수행 도중에도 변경 내용을 즉시 데이터베이스에 기록
-   커밋 발생 이전의 갱신은 원자성이 보장되지 않는 미완료 갱신이므로 장애 발생 시 UNDO 필요

## 2. 검사점 회복기법
- ### 장애 발생 시 검사점(Checkpoint) 이전에 처리된 트랜잭션은 회복에서 제외하고
- ### 검사점 이후에 처리된 트랜잭션은 회복 작업 수행
-           검사점 이후, 장애 발생 이전에 commit이 완료된 경우 Redo 수행
-           장애 발생 시점까지 commit되지 못한 경우 Undo 수행



## Commit 연산
